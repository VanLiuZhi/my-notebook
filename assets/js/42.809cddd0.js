(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{493:function(t,s,n){"use strict";n.r(s);var a=n(1),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"locust"}},[t._v("Locust")]),t._v(" "),n("p",[t._v("locust 是一个简单易用的测试工具。")]),t._v(" "),n("p",[t._v("官方文档："),n("a",{attrs:{href:"https://docs.locust.io/en/stable/what-is-locust.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.locust.io/en/stable/what-is-locust.html"),n("OutboundLink")],1)]),t._v(" "),n("h2",{attrs:{id:"文件描述符限制"}},[t._v("文件描述符限制")]),t._v(" "),n("p",[t._v("如果做高并发测试，操作系统会限制一个进程能够创建的文件描述符上限制，因为每个tcp连接都需要用到一个socket句柄。")]),t._v(" "),t._m(0),t._v(" "),n("p",[t._v("根据官方文档描述来看，模拟用户数超过能打开的文件数，会出现错误。")]),t._v(" "),n("h2",{attrs:{id:"如何使用"}},[t._v("如何使用")]),t._v(" "),n("p",[t._v("安装locust后，通过编写脚本，然后启动服务，此时通过浏览器端，就可以进行测试了。")]),t._v(" "),t._m(1),t._m(2),t._v(" "),n("h2",{attrs:{id:"ui界面描述"}},[t._v("UI界面描述")]),t._v(" "),t._m(3)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("ulimit -n 可以查看系统允许当前用户打开的文件数限制")]),this._v(" "),s("br"),this._v(" "),s("code",[this._v("ulimit -n 65535 可以修改限制，本次有效果")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-py extra-class"},[n("pre",{pre:!0,attrs:{class:"language-py"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("#!/usr/bin/env python")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# -*- coding: utf-8 -*-")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# @Time    : 2018/10/7 下午10:46")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# @Author  : liuzhi")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# @File    : locustfile.py")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("from")]),t._v(" locust "),n("span",{attrs:{class:"token keyword"}},[t._v("import")]),t._v(" HttpLocust"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" TaskSet"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" task\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("UserBehavior")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TaskSet"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    @task\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("sleep")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"/sleep"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    @task\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("woek")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("self"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        self"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("client"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("get"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"/work"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),n("span",{attrs:{class:"token class-name"}},[t._v("WebsiteUser")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HttpLocust"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    task_set "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" UserBehavior\n    min_wait "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("  "),n("span",{attrs:{class:"token comment"}},[t._v("# 单位 ms 请求等待的最小时间")]),t._v("\n    max_wait "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("# 测试server")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# locust --host=http://localhost:8888")]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("上述代码主要有两个类，UserBehavior类两个任务就是模拟当前用户的行为，sleep和work代表本次请求的用户将执行sleep和work操作，可以设置随机或同顺序，或者执行的比重。"),s("br"),s("code",[this._v("locust --host=http://localhost:8888")]),this._v("命令启动locust，8888代表测试服务的端口。")])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ul",[n("li",[t._v("Type：请求类型；")]),t._v(" "),n("li",[t._v("Name：请求路径；")]),t._v(" "),n("li",[t._v("requests：当前请求的数量；")]),t._v(" "),n("li",[t._v("fails：当前请求失败的数量；")]),t._v(" "),n("li",[t._v("Median：中间值，单位毫秒，一般服务器响应时间低于该值，而另一半高于该值；")]),t._v(" "),n("li",[t._v("Average：所有请求的平均响应时间，毫秒；")]),t._v(" "),n("li",[t._v("Min：请求的最小的服务器响应时间，毫秒；")]),t._v(" "),n("li",[t._v("Max：请求的最大服务器响应时间，毫秒；")]),t._v(" "),n("li",[t._v("Content Size：单个请求的大小，单位字节；10.reqs/sec：每秒钟请求的个数。")]),t._v(" "),n("li",[t._v("RPS: 服务器每秒能处理的请求数")])])}],!1,null,null,null);e.options.__file="README.md";s.default=e.exports}}]);